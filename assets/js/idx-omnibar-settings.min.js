window.addEventListener("DOMContentLoaded",function(){function e(e,t,n){for(var i=0;i<e.length;i++)t.call(n,e[i],i)}function t(){jQuery(".select2").select2({maximumSelectionLength:10,placeholder:"Select Up to Ten Fields"})}function n(){"undefined"!=typeof y&&y.addEventListener("click",function(e){e.preventDefault(),jQuery(".status").fadeIn("fast").html(p+"Saving Settings..."),d()})}function i(){e(v,function(e){e.addEventListener("change",o)})}function l(){jQuery(m).on("change",c)}function o(){return e(v,function(e){var t=e.name,n=e.value;"basic"!==t&&r(t,n)}),c()}function r(t,n){var i=m.querySelectorAll("."+t)[0],l=i.querySelectorAll("option");return e(l,function(e){e.getAttribute("data-mlsptid")!==n?e.disabled=!0:e.disabled=!1,"listingAgentID"!=e.getAttribute("value")&&"listingOfficeID"!=e.getAttribute("value")&&"coListingAgentID"!=e.getAttribute("value")&&"coListingOfficeID"!=e.getAttribute("value")&&"tertiaryListingAgentID"!=e.getAttribute("value")&&"tertiaryListingOfficeID"!=e.getAttribute("value")||(e.disabled=!0)}),a(m)}function a(e){return jQuery(e).select2("destroy"),jQuery(e).select2()}function c(){u();var t=m.selectedOptions;e(t,function(e){try{if(e.disabled===!0)throw e}catch(t){s(t.title)}})}function u(){document.querySelectorAll(".select2-container--default")[0].classList.remove("warning"),g.style.display="none",g.querySelector("p").innerHTML=""}function s(e){var t=e+" is not in the selected property type. Please choose a Custom Field within the selected MLS Specific Property Type.<br>";g.querySelector("p").insertAdjacentHTML("beforeend",t),g.style.display="block",document.querySelectorAll(".select2-container--default")[0].classList.add("warning")}function d(){if("undefined"!=typeof document.querySelectorAll(".city-list")[0]){var e=jQuery(".city-list select").val(),t=jQuery(".county-list select").val(),n=jQuery(".zipcode-list select").val();jQuery.post(ajaxurl,{action:"idx_update_omnibar_current_ccz","city-list":e,"county-list":t,"zipcode-list":n},function(){f()})}}function f(){if(void 0!==m.options){for(var e=[],t=0;t<m.options.length;t++)if(m.options[t].selected){var n=m.options[t].parentNode.classList[0],i=m.options[t].value,l=m.options[t].label,o=m.options[t].getAttribute("data-mlsptid"),r={idxID:n,value:i,mlsPtID:o,name:l};e.push(r)}for(var a=[],t=0;t<v.length;t++){var n=v[t].name,i=v[t].value,c={idxID:n,mlsPtID:i};a.push(c)}var u=document.querySelectorAll(".omnibar-placeholder")[0].value;jQuery.post(ajaxurl,{action:"idx_update_omnibar_custom_fields",fields:e,mlsPtIDs:a,placeholder:u},function(){window.location.reload()})}}"undefined"!=typeof loadOmnibarView&&jQuery.post(ajaxurl,{action:"idx_preload_omnibar_settings_view"},function(){window.location.reload()});var y=document.querySelectorAll("#save_changes")[0],p="<span class='ajax'></span>",v=document.querySelectorAll(".omnibar-mlsPtID"),m=document.querySelectorAll(".omnibar-additional-custom-field")[0],g=document.querySelectorAll(".customFieldError")[0];!function(){t(),n(),o(),i(),l()}()});